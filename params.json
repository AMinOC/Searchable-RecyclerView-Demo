{
  "name": "Searchable Recyclerview Demo",
  "tagline": "An example app using a SearchView to filter items in a RecyclerView while taking full advantage of item animations!",
  "body": " - **Backwards compatible all the way down to Froyo (Android 2.2, API leve 8)!**\r\n - **Item Animations are supported starting with Honeycomb (Android 3.0, API level 11)!**\r\n\r\n[![Get it on Google Play](https://developer.android.com/images/brand/en_generic_rgb_wo_60.png)](https://play.google.com/store/apps/details?id=com.github.wrdlbrnft.searchablerecyclerviewdemo)\r\n \r\n[![Build Status](https://travis-ci.org/Wrdlbrnft/Searchable-RecyclerView-Demo.svg?branch=master)](https://travis-ci.org/Wrdlbrnft/Searchable-RecyclerView-Demo)\r\n\r\nYou can find a walkthrough of how to implement an app with these features [**on Stack Overflow**](http://stackoverflow.com/a/30429439/2310866).\r\n\r\n# Table of Contents\r\n\r\n - [**About the app**](#about-the-app)\r\n - [**Build Environment**](#build-environment)\r\n  - [**Travis CI**](#travis-ci)\r\n  - [**Travis Build Script**](#travis-build-script)\r\n\r\n# About the app\r\n\r\nThe purpose of this app is to demonstrate how to efficiently filter items in a `RecyclerView` and perform appropriate item animations. If you are looking for a complete walkthrough of how to implement this feature in your app take a look at [**this answer I wrote on Stack Overflow**](http://stackoverflow.com/a/30429439/2310866). \r\n\r\nTwo important things I have to mention:\r\n\r\n - This app uses the Android Data Binding Framework. If you are unfamiliar with data binding check out the [**official guide on the Android Developer Website**](https://developer.android.com/topic/libraries/data-binding/index.html).\r\n - To simplify the implementation of the `RecyclerView.Adapter` this project uses the [**SortedListAdapter Library**](https://wrdlbrnft.github.io/SortedListAdapter/) which is also written by me. What this library exactly does and how it is implemented is explained in the [**Stack Overflow answer I mentioned above**](http://stackoverflow.com/a/30429439/2310866).\r\n\r\n## Demo Image\r\n\r\n![demo image](http://i.stack.imgur.com/qDtH7.gif) \r\n\r\n# Build Environment\r\n\r\nThis section will talk about how the app is built, tested and deployed. All of this is based on the principles of continous integration. I will not focus on the details in the `build.gradle` or things related to it, but about how the gradle build is executed and how the artifacts are deployed.\r\n\r\n## Travis CI\r\n\r\nTravis CI is used as a build server for this project. It is a cloud based continous integration solution that works very well with projects hosted on GitHub. By adding a simple build script to your repository you can do everything from building, testing and deploying a project. In the spirit of continous integration Travis will for each build set up a new virtual machine download and install all required dependencies (this also includes the Android SDK) and then continue to build and test the project. This ensures that everything that is contained in the repository works everywhere and isn't missing some dependency or required module. \r\n\r\nYou can set secret environment variables for each project you build on Travis. You would use that for things like API keys and passwords which you should never include in your repository directly.\r\n\r\n## Travis Build Script\r\n\r\nLet's take a look at the `.travis.yml` where all the build steps for this project are defined:\r\n\r\n```yaml\r\nlanguage: android\r\njdk: oraclejdk8\r\n\r\nenv:\r\n  global:\r\n    - ANDROID_TARGET=android-24\r\n    - ANDROID_ABI=armeabi-v7a\r\n\r\nandroid:\r\n  components:\r\n  - tools\r\n  - platform-tools\r\n  - build-tools-24.0.1\r\n  - android-24\r\n  - extra-android-m2repository\r\n  - sys-img-${ANDROID_ABI}-${ANDROID_TARGET}\r\n\r\nbefore_install:\r\n  - openssl aes-256-cbc -d -k $SECRET_FILES_KEY -in release.jks.enc -out release.jks\r\n  - openssl aes-256-cbc -d -k $SECRET_FILES_KEY -in keys.json.enc -out keys.json\r\n\r\nbefore_script:\r\n  - echo no | android create avd --force -n test -t $ANDROID_TARGET --abi $ANDROID_ABI\r\n  - emulator -avd test -no-skin -no-audio -no-window &\r\n  - android-wait-for-emulator\r\n\r\nscript:\r\n  - ./gradlew clean build assembleRelease connectedAndroidTest -Pversion_code=$TRAVIS_BUILD_NUMBER -Pversion_name=0.1.0.$TRAVIS_BUILD_NUMBER -Pkeystore_password=$KEYSTORE_PASSWORD -Pkey_alias=$KEY_ALIAS -Pkey_password=$KEY_PASSWORD\r\n\r\nafter_success:\r\n  - ./gradlew publishApkRelease -Pversion_code=$TRAVIS_BUILD_NUMBER -Pversion_name=0.1.0.$TRAVIS_BUILD_NUMBER -Pkeystore_password=$KEYSTORE_PASSWORD -Pkey_alias=$KEY_ALIAS -Pkey_password=$KEY_PASSWORD\r\n```\r\n\r\nTo understand every part of this let's brake it up into a few parts:\r\n\r\n### General Configuration\r\n\r\n```yaml\r\nlanguage: android\r\njdk: oraclejdk8\r\n```\r\n\r\nThis part at the top defines what you want to build and with what. In this case we are building an Android project and I want to use the Orace JDK 8 to do that. If you would want to build a normal Java project you would set `java` as language.\r\n\r\n### Environemt Variables\r\n\r\n```yaml\r\nenv:\r\n  global:\r\n    - ANDROID_TARGET=android-24\r\n    - ANDROID_ABI=armeabi-v7a\r\n```\r\n\r\nIn this section two environment variables are set. They define the api level and image type of the emulator image which is later used to execute the UI tests.\r\n\r\n### Defining Android SDK Components\r\n\r\n```yaml\r\nandroid:\r\n  components:\r\n  - tools\r\n  - platform-tools\r\n  - build-tools-24.0.1\r\n  - android-24\r\n  - extra-android-m2repository\r\n  - sys-img-${ANDROID_ABI}-${ANDROID_TARGET}\r\n```\r\n\r\nThis part defines all the Android SDK components that need to be installed on the build server to build the project. In this case that would be the tools and platform-tools as well as build tools version `24.0.1`. The SDK version used to build the project is defined with `android-24` since we are compiling for API level 24. `extra-android-m2repository` is the support repository which contains the support library. The last part is the system image for the emulator. We use the environment variables that were defined above to pick the right one.\r\n\r\n### Decrypting Secret Files\r\n\r\n```yaml\r\nbefore_install:\r\n  - openssl aes-256-cbc -d -k $SECRET_FILES_KEY -in release.jks.enc -out release.jks\r\n  - openssl aes-256-cbc -d -k $SECRET_FILES_KEY -in keys.json.enc -out keys.json\r\n```\r\n\r\nTo explain what this does I first need to explain something: The way Travis works is that all files required to build and deploy the project have to be included in the repository. This also includes sentive files like the release keystore which you definitely don't want to publicly distribute. To get around this problem you can include these files in the repository in an encrypted form and decrypt them on Travis only when the build is running. This is what happens above. In the repository the two files `release.jks.enc` and `keys.json.enc` are the release keystore and the json which among other things includes the private key for publishing the app to the Play Store. They are both encrypted using an AES 256 bit cipher and Travis can decrypt them before the build using the key phrase I set on Travis as an environment variable. \r\n\r\nYou can also execute other commands in the `before_install` section, everything you do in this section happens after the project has been checked out from GitHub, but before the actual build has started.\r\n\r\n### Starting the emulator for the UI tests\r\n\r\n```yaml\r\nbefore_script:\r\n  - echo no | android create avd --force -n test -t $ANDROID_TARGET --abi $ANDROID_ABI\r\n  - emulator -avd test -no-skin -no-audio -no-window &\r\n  - android-wait-for-emulator\r\n```\r\n\r\nThe `before_script` section is executed directly before the build. In it we start the emulator which we are going to use to execute the UI tests. Again both the environment variables `ANDROID_TARGET` and `ANDROID_ABI` are needed to pick the right system image for the emulator. \r\n\r\n### Building and Testing\r\n\r\n```yaml\r\nscript:\r\n  - ./gradlew clean build assembleRelease connectedAndroidTest -Pversion_code=$TRAVIS_BUILD_NUMBER -Pversion_name=0.1.0.$TRAVIS_BUILD_NUMBER -Pkeystore_password=$KEYSTORE_PASSWORD -Pkey_alias=$KEY_ALIAS -Pkey_password=$KEY_PASSWORD\r\n```\r\n\r\nThe `script` section is where you should define the actual build steps. This should be everything from building the project to running unit tests and ui tests. When all the commands in the `script` section are done your project should be fully built, tested and ready to be deployed. \r\n\r\nIn the case of this project we run the tasks `clean build assembleRelease` for a normal release build. The task `connectedAndroidTest` is what runs the UI tests.\r\n\r\nWith `-P` you can inject properties into the gradle script. We use that here to inject things like the version code and version name as well as the release keystore password and key password. `$TRAVIS_BUILD_NUMBER` is an environment variable which is set by Travis automatically and corresponds to the current number of the build. It starts at `1` and each time your project is built it is incremented.\r\n\r\nInside the `build.gradle` file of the app I check if the injected properties are present, otherwise (for example when I build the project locally on my computer) I fall back to default values that enable me to develop without having to set these properties:\r\n\r\n```groovy\r\napply plugin: 'com.android.application'\r\napply plugin: 'com.github.triplet.play'\r\n\r\n// These variables are used in the defaultConfig to set the version code and version name\r\nfinal travisVersionCode = hasProperty('version_code') ? property('version_code').toInteger() : 1\r\nfinal travisVersionName = hasProperty('version_name') ? property('version_name') : '0.1.0.0'\r\n\r\n// These variables are used for the release signingConfig\r\nfinal travisKeystorePassword = hasProperty('keystore_password') ? property('keystore_password') : ''\r\nfinal travisKeyAlias = hasProperty('key_alias') ? property('key_alias') : ''\r\nfinal travisKeyPassword = hasProperty('key_password') ? property('key_password') : ''\r\n\r\nandroid {\r\n    compileSdkVersion 24\r\n    buildToolsVersion '24.0.1'\r\n\r\n    dataBinding {\r\n        enabled true\r\n    }\r\n\r\n    defaultConfig {\r\n        applicationId 'com.github.wrdlbrnft.searchablerecyclerviewdemo'\r\n        minSdkVersion 7\r\n        targetSdkVersion 24\r\n        versionCode travisVersionCode\r\n        versionName travisVersionName\r\n    }\r\n\r\n    signingConfigs {\r\n        release {\r\n            storeFile rootProject.file('release.jks')\r\n            storePassword travisKeystorePassword\r\n            keyAlias travisKeyAlias\r\n            keyPassword travisKeyPassword\r\n        }\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            minifyEnabled true\r\n            signingConfig signingConfigs.release\r\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\r\n        }\r\n    }\r\n}\r\n\r\ndependencies {\r\n    compile 'com.android.support:appcompat-v7:24.1.1'\r\n    compile 'com.android.support:recyclerview-v7:24.1.1'\r\n    compile 'com.github.wrdlbrnft:sorted-list-adapter:0.1.0.5'\r\n}\r\n\r\nplay {\r\n    track = 'production'\r\n    jsonFile = rootProject.file('keys.json')\r\n}\r\n```\r\n\r\n### Deploying the APK to the Play Store\r\n\r\nNow there is only on part of the `.travis.yml` remaining:\r\n\r\n```yaml\r\nafter_success:\r\n  - ./gradlew publishApkRelease -Pversion_code=$TRAVIS_BUILD_NUMBER -Pversion_name=0.1.0.$TRAVIS_BUILD_NUMBER -Pkeystore_password=$KEYSTORE_PASSWORD -Pkey_alias=$KEY_ALIAS -Pkey_password=$KEY_PASSWORD\r\n```\r\n\r\nThe `after_success` section is executed if the build was successful and it's where you are supposed to deploy your artifacts. This projects uses the [**Gradle Play Publisher**](https://github.com/Triple-T/gradle-play-publisher) plugin to deploy the apk to the Play Store. Since this is still a gradle operation we still need to inject the same gradle properties as above when executing the `publishApkRelease` task. ",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}